!function(){var e,t,i;!function(n){function o(e,t){return y.call(e,t)}function s(e,t){var i,n,o,s,r,a,l,c,d,f,u,m=t&&t.split("/"),h=v.map,w=h&&h["*"]||{};if(e&&"."===e.charAt(0))if(t){for(e=e.split("/"),r=e.length-1,v.nodeIdCompat&&j.test(e[r])&&(e[r]=e[r].replace(j,"")),e=m.slice(0,m.length-1).concat(e),d=0;d<e.length;d+=1)if(u=e[d],"."===u)e.splice(d,1),d-=1;else if(".."===u){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((m||w)&&h){for(i=e.split("/"),d=i.length;d>0;d-=1){if(n=i.slice(0,d).join("/"),m)for(f=m.length;f>0;f-=1)if(o=h[m.slice(0,f).join("/")],o&&(o=o[n])){s=o,a=d;break}if(s)break;!l&&w&&w[n]&&(l=w[n],c=d)}!s&&l&&(s=l,a=c),s&&(i.splice(0,a,s),e=i.join("/"))}return e}function r(e,t){return function(){var i=C.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),m.apply(n,i.concat([e,t]))}}function a(e){return function(t){return s(t,e)}}function l(e){return function(t){p[e]=t}}function c(e){if(o(g,e)){var t=g[e];delete g[e],b[e]=!0,u.apply(n,t)}if(!o(p,e)&&!o(b,e))throw new Error("No "+e);return p[e]}function d(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]}function f(e){return function(){return v&&v.config&&v.config[e]||{}}}var u,m,h,w,p={},g={},v={},b={},y=Object.prototype.hasOwnProperty,C=[].slice,j=/\.js$/;h=function(e,t){var i,n=d(e),o=n[0];return e=n[1],o&&(o=s(o,t),i=c(o)),o?e=i&&i.normalize?i.normalize(e,a(t)):s(e,t):(e=s(e,t),n=d(e),o=n[0],e=n[1],o&&(i=c(o))),{f:o?o+"!"+e:e,n:e,pr:o,p:i}},w={require:function(e){return r(e)},exports:function(e){var t=p[e];return"undefined"!=typeof t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:f(e)}}},u=function(e,t,i,s){var a,d,f,u,m,v,y=[],C=typeof i;if(s=s||e,"undefined"===C||"function"===C){for(t=!t.length&&i.length?["require","exports","module"]:t,m=0;m<t.length;m+=1)if(u=h(t[m],s),d=u.f,"require"===d)y[m]=w.require(e);else if("exports"===d)y[m]=w.exports(e),v=!0;else if("module"===d)a=y[m]=w.module(e);else if(o(p,d)||o(g,d)||o(b,d))y[m]=c(d);else{if(!u.p)throw new Error(e+" missing "+d);u.p.load(u.n,r(s,!0),l(d),{}),y[m]=p[d]}f=i?i.apply(p[e],y):void 0,e&&(a&&a.exports!==n&&a.exports!==p[e]?p[e]=a.exports:f===n&&v||(p[e]=f))}else e&&(p[e]=i)},e=t=m=function(e,t,i,o,s){if("string"==typeof e)return w[e]?w[e](t):c(h(e,t).f);if(!e.splice){if(v=e,v.deps&&m(v.deps,v.callback),!t)return;t.splice?(e=t,t=i,i=null):e=n}return t=t||function(){},"function"==typeof i&&(i=o,o=s),o?u(n,e,t,i):setTimeout(function(){u(n,e,t,i)},4),m},m.config=function(e){return m(e)},e._defined=p,i=function(e,t,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(i=t,t=[]),o(p,e)||o(g,e)||(g[e]=[e,t,i])},i.amd={jQuery:!0}}(),i("../../assets/js/lib/almond",function(){}),i("models/formModel",[],function(){var e=Backbone.Model.extend({defaults:{objectType:"form",id:0,title:"unknown",created_at:"unknown"},url:function(){return ajaxurl+"?action=nf_forms&form_id="+this.get("id")},initialize:function(){this.set("id",Number(this.get("id"))),this.get("id")&&this.initShortcode(this.get("id")),this.get("title")&&this.set("title",this.get("title").replace(/<\/?[^>]+(>|$)/g,""))},initShortcode:function(e){var t="[ninja_form id="+e+"]";this.set("shortcode",t)},destroy:function(){var e=this;jQuery.ajax({type:"POST",url:ajaxurl+"?action=nf_forms&method_override=delete&form_id="+this.get("id"),success:function(t){var t=JSON.parse(t);e.collection.remove(e)}})}});return e}),i("models/formCollection",["models/formModel"],function(e){var t=Backbone.Collection.extend({model:e,comparator:"title",tmpNum:1,url:function(){return ajaxurl+"?action=nf_forms"},initialize:function(){this.newIDs=[],this.listenTo(n.channel("dashboard"),"forms:delete",this.modalConfirm),this.listenTo(n.channel("dashboard"),"forms:duplicate",this.duplicate),this.modal=new jBox("Modal",{width:300,addClass:"dashboard-modal",overlay:!0,closeOnClick:"body"})},parse:function(e,t){return e.data},modalConfirm:function(e){var t='<div class="message"><p>Once deleted, a Form cannot be recovered.<br />Are you sure you want to delete <em>'+e.model.get("title")+"</em>?</p></div>";t+='<div class="buttons"><div class="confirm nf-button primary">Delete</div> <div style="float:right;" class="cancel nf-button secondary">Cancel</div></div>',this.modal.setContent(t),this.modal.setTitle("Confirm Delete"),this.modal.open();var i=this,n=this.modal.container[0].getElementsByClassName("cancel")[0];n.addEventListener("click",function(){i.modalClose()});var o=this.modal.container[0].getElementsByClassName("confirm")[0];o.addEventListener("click",function(){i.confirmDelete(e)})},modalClose:function(){this.modal.close()},confirmDelete:function(e){jQuery(e.el).removeClass("show-actions"),jQuery(e.el).addClass("deleting"),jQuery(e.el).animate({opacity:0,"line-height":0,display:"none"},500),e.model.destroy(),this.modalClose()},duplicate:function(e){var t='<div class="message">Duplicating <em>'+e.model.get("title")+'</em>...<div class="nf-loading-spinner"></div></div>';this.modal.setContent(t),this.modal.setTitle("Please Wait"),this.modal.open();var i=this;jQuery.ajax({type:"POST",url:ajaxurl+"?action=nf_forms&clone_id="+e.model.get("id"),success:function(t){var t=JSON.parse(t),n=t.data.new_form_id,o=e.model.clone();o.set({id:n,title:o.get("title")+" - copy",created_at:new Date}),o.initShortcode(n),e.model.collection.add(o),i.modalClose()}})}});return t}),i("controllers/formsController",["models/formModel","models/formCollection"],function(e,t){var i=Marionette.Object.extend({initialize:function(){this.forms=new t,n.channel("dashboard").reply("get:forms",this.getForms,this),this.forms.fetch({success:function(e){n.channel("dashboard").trigger("fetch:forms",e)}})},getForms:function(){return this.forms}});return i}),i("views/widgets/forms/formsFilter",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-widget-forms-filter",ui:{input:"input"},events:{"keyup @ui.input":"updateFilter"},initialize:function(){this.listenTo(n.channel("widget-forms"),"change:content",this.clearFilter)},updateFilter:function(){var e=this.getUI("input").val();n.channel("widget-forms").trigger("update:filter",e)},clearFilter:function(){this.getUI("input").val("")},updatePlaceholder:function(e){this.getUI("input").attr("placeholder",e)}});return e}),i("views/widgets/forms/formsTableRow",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-row",tagName:"tr",replaceElement:!0,ui:{delete:".delete",duplicate:".duplicate",edit:".nf-item-edit"},events:{"click @ui.delete":function(){n.channel("dashboard").trigger("forms:delete",this)},"click @ui.duplicate":function(){n.channel("dashboard").trigger("forms:duplicate",this)},"click @ui.edit":function(e){this.$el.toggleClass("show-actions").siblings().removeClass("show-actions")}},templateContext:function(){var e=this.model;return{created_at:moment(e.get("created_at")).format("MM/DD/YY h:mm A")}}});return e}),i("views/widgets/forms/formsTableEmpty",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-empty",tagName:"tr"});return e}),i("views/widgets/forms/formsTableBody",["views/widgets/forms/formsTableRow","views/widgets/forms/formsTableEmpty"],function(e,t){var i=Marionette.CollectionView.extend({childView:e,emptyView:t,className:"forms-collection",tagName:"tbody",initialize:function(){this.listenTo(n.channel("widget-forms"),"update:filter",this.updateFilter)},updateFilter:function(e){this.setFilter(function(t,i,n){return 0<=t.get("title").toLowerCase().indexOf(e.toLowerCase())})}});return i}),i("views/widgets/forms/formsTableLoading",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-widget-forms-table-loading",tagName:"tr"});return e}),i("views/widgets/forms/formsTable",["views/widgets/forms/formsTableBody","views/widgets/forms/formsTableLoading","models/formCollection"],function(e,t,i){var o=Marionette.View.extend({template:"#tmpl-nf-widget-forms-table",className:"nf-table-display",tagName:"table",initialize:function(){var t=this;this.listenTo(n.channel("dashboard"),"fetch:forms",function(i){t.showChildView("body",new e({collection:i}))})},regions:{body:{el:"tbody",replaceElement:!0}},ui:{sortable:".sortable",body:"tbody",action2:".action2",more:".more",less:".less"},onRender:function(){this.getUI("less").hide();var i=n.channel("dashboard").request("get:forms");"undefined"==typeof i?this.showChildView("body",new t):this.showChildView("body",new e({collection:i})),this.maybeHideMoreButton()},events:{"click @ui.sortable":"sortFormsTable","click @ui.more":"showMore","click @ui.less":"showLess"},sortFormsTable:function(e){this.getUI("sortable").removeClass("sorted-asc"),this.getUI("sortable").removeClass("sorted-desc");var t=jQuery(e.target).data("sort"),i=jQuery(e.target).data("reverse")||0;i?(jQuery(e.target).addClass("sorted-desc"),jQuery(e.target).removeClass("sorted-asc")):(jQuery(e.target).addClass("sorted-asc"),jQuery(e.target).removeClass("sorted-desc"));var n=this.getChildView("body").collection;n.comparator=function(e,n){return name1=e.get(t).toLowerCase(),name2=n.get(t).toLowerCase(),name1<name2?ret=-1:name1>name2?ret=1:ret=0,i&&(ret=-ret),ret},n.sort(),i?(n.models.reverse(),jQuery(e.target).data("reverse",0)):jQuery(e.target).data("reverse",1)},showMore:function(){this.getUI("more").hide(),this.getUI("less").show(),this.getUI("body").addClass("more")},showLess:function(){this.getUI("less").hide(),this.getUI("more").show(),this.getUI("body").removeClass("more")},maybeHideMoreButton:function(){"undefined"!=typeof this.collection&&10<this.collection.length||this.getUI("action2").hide()}});return o}),i("models/formTemplateModel",[],function(){var e=Backbone.Model.extend({defaults:{objectType:"template",id:"none",title:"unknown"},initialize:function(){this.set("desc",this.get("template-desc"))}});return e}),i("models/formTemplateCollection",["models/formTemplateModel"],function(e){var t=Backbone.Collection.extend({model:e,tmpNum:1,url:function(){return ajaxurl+"?action=nf_new_form_templates"},parse:function(e,t){return e.data},initialize:function(){this.fetch({success:function(e){},error:function(e){}})}});return t}),i("views/widgets/forms/newFormTemplate",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-widget-forms-template"});return e}),i("views/widgets/forms/newFormGrid",["models/formTemplateCollection","views/widgets/forms/newFormTemplate"],function(e,t){var i=Marionette.CollectionView.extend({tagName:"div",className:"template-list",collection:new e,childView:t,initialize:function(){this.listenTo(n.channel("widget-forms"),"update:filter",this.updateFilter)},updateFilter:function(e){this.setFilter(function(t,i,n){return 0<=t.get("title").toLowerCase().indexOf(e.toLowerCase())})}});return i}),i("views/widgets/forms/forms",["views/widgets/forms/formsFilter","views/widgets/forms/formsTable","views/widgets/forms/newFormGrid"],function(e,t,i){var o=Marionette.View.extend({template:"#tmpl-nf-widget-forms",regions:{filter:".filter",content:".content"},ui:{add:".add",cancel:".cancel"},initialize:function(){n.channel("widget-forms").reply("show:newFormsGrid",this.showNewFormGrid,this),n.channel("widget-forms").reply("show:formsTable",this.showFormsTable,this)},onRender:function(){this.getUI("cancel").hide(),this.showChildView("filter",new e),"#new-form"==window.location.hash?(this.getUI("add").hide(),this.getUI("cancel").show(),this.showChildView("content",new i)):this.showChildView("content",new t)},events:{"click @ui.add":"showNewFormGrid","click @ui.cancel":"showFormsTable"},showNewFormGrid:function(){window.location.hash="new-form",this.showChildView("content",new i),n.channel("widget-forms").trigger("change:content"),this.getUI("add").hide(),this.getUI("cancel").show(),this.getChildView("filter").updatePlaceholder("Search Templates")},showFormsTable:function(){console.log(this),window.location.hash="forms",this.showChildView("content",new t),n.channel("widget-forms").trigger("change:content"),this.getUI("cancel").hide(),this.getUI("add").show(),this.getChildView("filter").updatePlaceholder("Search Forms")}});return o}),i("views/sections/widgets.js",["views/widgets/forms/forms"],function(e){var t=Marionette.View.extend({template:"#tmpl-nf-widgets",regions:{forms:".widget-forms"},onRender:function(){this.showChildView("forms",new e)}});return t}),i("views/sections/apps.js",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-apps"});return e}),i("views/sections/memberships.js",[],function(){var e=Marionette.View.extend({template:"#tmpl-nf-memberships"});return e}),i("views/dashboardView",["views/sections/widgets.js","views/sections/apps.js","views/sections/memberships.js"],function(e,t,i){var o=Marionette.View.extend({template:"#tmpl-nf-dashboard",currentView:"widgets",regions:{content:".content"},events:{"click .widgets a":function(t){this.showChildView("content",new e),jQuery("."+this.currentView).find("a").removeClass("active"),t.target.classList.add("active"),this.currentView="widgets"},"click .apps a":function(e){this.showChildView("content",new t),jQuery("."+this.currentView).find("a").removeClass("active"),e.target.classList.add("active"),this.currentView="apps"},"click .memberships a":function(e){this.showChildView("content",new i),jQuery("."+this.currentView).find("a").removeClass("active"),e.target.classList.add("active"),this.currentView="memberships"}},initialize:function(){switch(window.location.hash){case"#apps":this.currentView="apps";break;case"#memberships":this.currentView="memberships";break;case"#widgets":default:this.currentView="widgets"}n.channel("dashboard").reply("show:widgets",function(){this.showChildView("content",new e),jQuery("nav.sections a.active").removeClass("active"),jQuery("nav.sections .widgets a").addClass("active"),this.currentView="widgets"},this),n.channel("dashboard").reply("show:apps",function(){this.showChildView("content",new t),jQuery("nav.sections a.active").removeClass("active"),jQuery("nav.sections .apps a").addClass("active"),this.currentView="apps"},this)},onRender:function(){switch(window.location.hash){case"#apps":var n=new t;break;case"#memberships":var n=new i;break;case"#widgets":default:var n=new e}this.showChildView("content",n)},templateContext:function(){var e=this;return{renderNav:function(){var t="";return _.each(nfDashItems,function(i){var n=e.currentView==i.slug?" active":"";t+='<li class="'+i.slug+'"><a href="#'+i.slug+'" class="'+n+'">'+i.niceName+"</a></li>"}),t}}}});return o});var n=Backbone.Radio,o=!1;jQuery(document).ready(function(e){t(["controllers/formsController","views/dashboardView"],function(t,i){var n=Marionette.Application.extend({region:"#ninja-forms-dashboard",controllers:{},initialize:function(e){var t=this;Marionette.Renderer.render=function(e,i){var e=t.template(e);return e(i)},o&&console.log("Dashboard Initialized")},onStart:function(){this.showView(new i),this.controllers.forms=new t,o&&console.log("Dashboard Started")},template:function(t){return _.template(e(t).html(),{evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g,variable:"data"})}}),s=new n;s.start()})}),jQuery('a[href="admin.php?page=ninja-forms#new-form"]').on("click",function(){event.preventDefault(),window.location.hash="new-form",n.channel("dashboard").request("show:widgets"),n.channel("widget-forms").request("show:newFormsGrid")}),jQuery('a[href="admin.php?page=ninja-forms#apps"]').on("click",function(){event.preventDefault(),window.location.hash="apps",n.channel("dashboard").request("show:apps")}),jQuery('a[href="admin.php?page=ninja-forms"]').on("click",function(e){e.preventDefault(),window.location.hash="forms",n.channel("dashboard").request("show:widgets"),n.channel("widget-forms").request("show:formsTable")}),i("main",function(){})}();
//# sourceMappingURL=almond.build.js.map
//# sourceMappingURL=dashboard.min.js.map
